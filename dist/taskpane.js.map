{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable no-undef */\n/*\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\n * See LICENSE in the project root for license information.\n */\n\n/* global document, Office, Word */\nvar templateOptions = \"<option value=''>Select a template</option>\";\nvar carOptions = \"<option value=''>Select a car</option>\";\nvar productListOptions = \"<option value=''>Select product</option>\";\nvar productTextsOptions = \"<option value=''>Select product text</option>\";\nvar i;\nvar proId = \"\";\nvar downfilesBuf = [];\nvar g_car_id = 1;\nvar template_status = \"\";\nvar g_type_atoi = { car: 1, bike: 2 };\n//var months = [{\"jan\":0}, {\"feb\":1}, {\"mar\":2}, {\"apr\":3}, {\"may\":4}, {\"jun\":5}, {\"jul\":6}, {\"aug\":7}, {\"sep\":8}, {\"oct\":9}, {\"nov\":10}, {\"dec\":11}];\nvar months = { jan: 0, feb: 2, mar: 3, apr: 4, may: 5, jun: 6, jul: 7, aug: 8, sep: 9, oct: 10, nov: 11, dec: 12 };\n\n//my var\nvar jsonObject = {};\nvar currentObject = {};\nvar g_template_id = 1;\nvar g_fname = \"template1.docx\";\nvar max_field_id = 1;\nvar max_car_value_id = 1;\nvar max_car_id = 1;\nvar g_default_fields = {};\nvar g_template_names = {};\nvar g_dir_names = {};\nvar g_current_dir = \"\";\nvar g_current_dir_option = \"\";\nvar g_client_token;\nvar g_server_token = \"\";\ng_token = \"\";\nvar g_connected = false;\nvar g_cc_type = 1;\nvar g_is_new = false;\nvar g_new_template = 0;\n\n$(function () {\n  // next add the onclick handler\n  $(window).click(function (event) {\n    if ($(event.target).attr(\"id\") == \"myModal\") {\n      $(\"#dialog-menu\").css(\"display\", \"none\");\n      $(\"#dialog-setting\").css(\"display\", \"none\");\n      $(\"#dialog-save\").css(\"display\", \"none\");\n      $(\"#dialog-template\").css(\"display\", \"none\");\n      $(\"#dialog-newfolder\").css(\"display\", \"none\");\n      $(\"#dialog-save-confirm\").css(\"display\", \"none\");\n      $(\"#dialog-car-name\").css(\"display\", \"none\");\n      $(\"#dialog-about\").css(\"display\", \"none\");\n      $(\"#dialog-alert\").css(\"display\", \"none\");\n      $(\"#myModal\").css(\"display\", \"none\");\n    }\n  });\n\n  $(document).on(\"click\", \".close\", function () {\n    $(this).parent().parent().css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#menu\", function () {\n    updateStatus(\"kcg=\");\n    // $(\"#dialog-menu\").css(\"display\", \"block\");\n    // $(\"#myModal\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#menu-template\", function () {\n    $(\"#dialog-menu\").css(\"display\", \"none\");\n    $(\"#dialog-template\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-close-template\", function () {\n    $(\"#dialog-template\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-newfolder\", function () {\n    $(\"#dialog-template\").css(\"display\", \"none\");\n    $(\"#dialog-newfolder\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-close-newfolder\", function () {\n    $(\"#dialog-newfolder\").css(\"display\", \"none\");\n    $(\"#dialog-template\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-save-newfolder\", function () {\n    $(\"#dialog-newfolder\").css(\"display\", \"none\");\n    $(\"#dialog-template\").css(\"display\", \"block\");\n    var name = $(\"#newfolder\").val();\n    var req = \"?newfolder=\" + name;\n    var myVar;\n    myVar = setTimeout(function () {\n      g_server_token = \"\";\n      g_token = \"\";\n      $(\"#table-setting-success\").css(\"display\", \"none\");\n      $(\"#table-setting\").css(\"display\", \"block\");\n\n      $(\"#button-connect\").html(\"Connect\");\n      $(\"#dialog-setting\").css(\"display\", \"none\");\n      alarm(\"Can't connect to Server\", \"\");\n      $(\"#div-alarm\").css(\"color\", \"red\");\n    }, 2000);\n\n    $.get(\n      gval.serverURI + req + g_token,\n      {},\n      function (data) {\n        if (data[\"status\"] == \"success\") {\n          clearTimeout(myVar);\n          var max_id;\n          for (var id in g_dir_names) {\n            if (max_id < id) max_id = id;\n          }\n          max_id++;\n          g_dir_names[max_id] = name;\n          insertFileItem_js(\"dir\", max_id, name, \"close\");\n          insertFileItem_js(\"dir\", max_id, name, \"\");\n          if (g_current_dir_option == \"\") {\n            $(\"#select-template option\")\n              .eq(1)\n              .before($(\"<option>[\" + name + \"]</option>\"));\n          }\n        }\n      },\n      \"json\"\n    );\n  });\n\n  $(document).on(\"click\", \"#menu-setting\", function () {\n    $(\"#dialog-menu\").css(\"display\", \"none\");\n    $(\"#dialog-setting\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-connect\", function () {\n    var myVar;\n    myVar = setTimeout(function () {\n      if (g_server_token == \"\") {\n        $(\"#table-setting-success\").css(\"display\", \"none\");\n        $(\"#table-setting\").css(\"display\", \"block\");\n        $(\"#myModal\").css(\"display\", \"block\");\n\n        $(\"#button-connect\").html(\"Connect\");\n        // $(\"#button-connect\").css(\"width\", \"120px\");\n        // $(\"#button-connect\").css(\"height\", \"40px\");\n        alarm(\"Can't connect to Server\", \"\");\n        $(\"#div-alarm\").css(\"color\", \"red\");\n        $(\"#dialog-setting\").css(\"display\", \"none\");\n      }\n    }, 2000);\n\n    var disconnect = \"\";\n    if (g_server_token) disconnect = \"&disconnect\";\n    $.get(\n      gval.serverURI + \"?stoken=\" + g_client_token + disconnect,\n      {},\n      function (returnData) {\n        if (returnData[\"status\"] == \"success\") {\n          // updateStatus(\" ::token SUCCESS!!! \");\n          g_server_token = returnData[\"plugin_token\"];\n          // $(\"#copied_token\").val(g_server_token);\n          g_connected = true;\n          alarm(\"Connected to API\", \"\");\n          $(\"#div-alarm\").css(\"color\", \"green\");\n          getToken();\n          // updateStatus(\"\", \"\");\n          initTemplate_js();\n          initCars_js();\n          initUI();\n          clearTimeout(myVar);\n          $(\"#dialog-setting\").css(\"display\", \"none\");\n          $(\"#myModal\").css(\"display\", \"none\");\n        } else if (returnData[\"status\"] == \"disconnect\") {\n          //add-action\n          alarm(\"Go Setting & Connect to API\", \"\");\n          $(\"#div-alarm\").css(\"color\", \"red\");\n          $(\"#table-setting-success\").css(\"display\", \"none\");\n          $(\"#table-setting\").css(\"display\", \"block\");\n\n          $(\"#button-connect\").html(\"Connect\");\n          // $(\"#button-connect\").css(\"width\", \"120px\");\n          // $(\"#button-connect\").css(\"height\", \"40px\");\n\n          $(\"#dialog-setting\").css(\"display\", \"none\");\n          $(\"#myModal\").css(\"display\", \"none\");\n\n          $(\"#copied-token\").val(\"\");\n          document.getElementById(\"select-template\").innerHTML = \"\";\n          initUI();\n          g_server_token = \"\";\n          clearTimeout(myVar);\n        } else {\n          alarm(\"Can't connect to Server\", \"\");\n          $(\"#div-alarm\").css(\"color\", \"red\");\n\n          $(\"#dialog-setting\").css(\"display\", \"none\");\n          $(\"#myModal\").css(\"display\", \"none\");\n        }\n      },\n      \"json\"\n    );\n  });\n\n  $(document).on(\"click\", \"#button-cancel-setting\", function () {\n    $(\"#dialog-setting\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    // $(\"#dialog-menu\").dialog(\"close\");\n    // $(\"#dialog-about\").dialog(\"open\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#menu-about\", function () {\n    $(\"#dialog-menu\").css(\"display\", \"none\");\n    $(\"#dialog-about\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-close-about\", function () {\n    $(\"#myModal\").css(\"display\", \"none\");\n    $(\"#dialog-about\").css(\"display\", \"none\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-close-alert\", function () {\n    $(\"#myModal\").css(\"display\", \"none\");\n    $(\"#dialog-about\").css(\"display\", \"none\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#save-template\", function () {\n    if (g_new_template == 1) $(\"#save-doc-name\").val(\"\");\n    $(\"#myModal\").css(\"display\", \"block\");\n    $(\"#dialog-save\").css(\"display\", \"block\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-close-savetemplate\", function () {\n    $(\"#dialog-save\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-save-template\", function () {\n    var doc_name = \"\";\n    var full_name = \"\";\n    var is_duplicate = false;\n    doc_name = $(\"#save-doc-name\").val();\n\n    if (doc_name == \"\") return;\n    if (!doc_name.endsWith(\".docx\")) {\n      doc_name += \".docx\";\n    }\n\n    if (g_current_dir != \"\") {\n      full_name = g_current_dir + \"/\" + doc_name;\n    } else {\n      full_name = doc_name;\n    }\n\n    for (var i in g_template_names) {\n      if (full_name == g_template_names[i]) {\n        is_duplicate = true;\n        break;\n      }\n    }\n\n    $(\"#dialog-save\").css(\"display\", \"none\");\n    if (is_duplicate == true) {\n      $(\"#dialog-overwrite\").css(\"display\", \"block\");\n    } else {\n      $(\"#myModal\").css(\"display\", \"none\");\n      currentObject[\"fname\"] = full_name;\n      if (currentObject[\"status\"] == \"add\") {\n        currentObject[\"id\"] = -1;\n      }\n      sendFile();\n    }\n  });\n\n  $(document).on(\"click\", \"#button-no-overwrite\", function () {\n    $(\"#dialog-overwrite\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-yes-overwrite\", function () {\n    $(\"#dialog-overwrite\").css(\"display\", \"none\");\n    $(\"#dialog-save\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    var doc_name = \"\";\n    var full_name = \"\";\n    doc_name = $(\"#save-doc-name\").val();\n\n    if (!doc_name.endsWith(\".docx\")) {\n      doc_name += \".docx\";\n    }\n\n    if (g_current_dir != \"\") {\n      full_name = g_current_dir + \"/\" + doc_name;\n    } else {\n      full_name = doc_name;\n    }\n    currentObject[\"fname\"] = full_name;\n    if (currentObject[\"status\"] == \"add\" || currentObject[\"status\"] == \"\") currentObject[\"status\"] = \"replace\";\n\n    for (var i in g_template_names) {\n      if (full_name == g_template_names[i]) {\n        currentObject[\"id\"] = i;\n        break;\n      }\n    }\n\n    sendFile();\n    return true;\n  });\n\n  $(document).on(\"click\", \"#add-template\", function () {\n    if (currentObject[\"status\"] == \"update\") {\n      $(\"#myModal\").css(\"display\", \"block\");\n      $(\"#dialog-save-confirm\").css(\"display\", \"block\");\n      // sendFile();\n    } else {\n      g_new_template = 1;\n      currentObject[\"status\"] = \"add\";\n      initTemplate_js();\n      initCars_js();\n      initUI();\n    }\n    return false;\n  });\n\n  $(document).on(\"click\", \"#button-yes-confirm\", function () {\n    $(\"#dialog-save-confirm\").css(\"display\", \"none\");\n\n    if (g_new_template == 1) $(\"#save-doc-name\").val(\"\");\n    $(\"#dialog-save\").css(\"display\", \"block\");\n  });\n\n  $(document).on(\"click\", \"#button-no-confirm\", function () {\n    $(\"#dialog-save-confirm\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n    g_new_template = 1;\n    currentObject[\"status\"] = \"\";\n    initTemplate_js();\n    // initCars_js();\n    // initUI();\n  });\n\n  $(document).on(\"click\", \"#button-cancel-confirm\", function () {\n    $(\"#dialog-save-confirm\").css(\"display\", \"none\");\n    $(\"#myModal\").css(\"display\", \"none\");\n  });\n\n  $(document).on(\"click\", \".file-delete\", function () {\n    var row = $(this).parent().parent(\"tr\");\n    var id = $(this).attr(\"id\");\n    var type = id.split(\"-\")[1];\n    id = id.split(\"-\")[2];\n    var name = \"\";\n    var req = \"?\";\n\n    if (type == \"dir\") {\n      $(this)\n        .parent()\n        .parent()\n        .children(\".dir-name\")\n        .map(function () {\n          name = $(this).html();\n        });\n      req = \"?delete_dir=\" + name;\n    } else {\n      name = g_template_names[id];\n      req = \"?delete_file=\" + name;\n    }\n    var myVar;\n    myVar = setTimeout(function () {\n      g_server_token = \"\";\n      g_token = \"\";\n      $(\"#table-setting-success\").css(\"display\", \"none\");\n      $(\"#table-setting\").css(\"display\", \"block\");\n\n      $(\"#button-connect\").html(\"Connect\");\n      // $(\"#button-connect\").css(\"width\", \"120px\");\n      // $(\"#button-connect\").css(\"height\", \"40px\");\n      alarm(\"Can't connect to Server\", \"\");\n      $(\"#div-alarm\").css(\"color\", \"red\");\n    }, 2000);\n    $.get(\n      gval.serverURI + req + g_token,\n      {},\n      function (data) {\n        var i;\n        if (data[\"status\"] == \"success\") {\n          clearTimeout(myVar);\n          // if (type == \"file\")\n          row.remove();\n          if (type == \"file\") {\n            for (i in g_template_names) {\n              if (name == g_template_names[i]) {\n                delete g_template_names[i];\n              }\n            }\n            $(\"#select-template option[value=\" + id + \"]\").remove();\n          } else {\n            for (i in g_dir_names) {\n              if (name == g_dir_names[i]) {\n                delete g_dir_names[i];\n              }\n            }\n\n            $(\"#select-template option\").map(function () {\n              if (\n                $(this)\n                  .html()\n                  .startsWith(\"[\" + name + \"]\")\n              ) {\n                $(this).remove();\n              }\n            });\n          }\n\n          if (type == \"file\") {\n            $(\"#tbody-saved-files > #tr-file-\" + id).remove();\n          } else {\n            $(\"#tbody-saved-dirs > #tr-dir-\" + id).remove();\n          }\n          if (g_template_id == id) {\n            $(\"#select-template option\").last().prop(\"selected\", true);\n            changeTemplate_js();\n            // $(\"#select-template option\").val(val).trigger(\"change\");\n          }\n        }\n      },\n      \"json\"\n    );\n    return true;\n  });\n\n  $(document).on(\"click\", \".copy-doc\", function () {\n    var row = $(this).parent().parent(\"tr\");\n    var id = $(this).attr(\"id\");\n    id = id.split(\"-\")[2];\n    var name = \"\";\n    var req = \"?\";\n\n    // name = $(this).html();\n\n    $(this)\n      .parent()\n      .parent()\n      .children(\".file-name\")\n      .map(function () {\n        name = $(this).html();\n      });\n\n    // if (type == \"dir\") req = \"?delete_dir=\" + name;\n    // else\n    req = \"?copy_file=\" + id;\n    var myVar;\n    myVar = setTimeout(function () {\n      g_server_token = \"\";\n      g_token = \"\";\n      $(\"#table-setting-success\").css(\"display\", \"none\");\n      $(\"#table-setting\").css(\"display\", \"block\");\n\n      $(\"#button-connect\").html(\"Connect\");\n      // $(\"#button-connect\").css(\"width\", \"120px\");\n      // $(\"#button-connect\").css(\"height\", \"40px\");\n      alarm(\"Can't connect to Server\", \"\");\n      $(\"#div-alarm\").css(\"color\", \"red\");\n    }, 2000);\n    $.get(\n      gval.serverURI + req + g_token,\n      {},\n      function (data) {\n        //updateStatus(\"copy file---data: \" + JSON.stringify(data));\n        if (data[\"status\"] == \"success\") {\n          clearTimeout(myVar);\n          var new_id = data[\"id\"];\n          var new_name = data[\"name\"];\n          var dir_name = \"\";\n          var max_dir_id = 0;\n\n          g_template_names[new_id] = new_name;\n\n          var arr = new_name.split(\"/\");\n          if (arr.length > 1) {\n            dir_name = arr[0];\n            new_name = arr[1];\n          }\n\n          if (g_current_dir_option == dir_name) {\n            $(\"#select-template\").append(new Option(new_name, new_id));\n          }\n\n          insertFileItem_js(\"file\", new_id, new_name, \"close\");\n          insertFileItem_js(\"file\", new_id, new_name, \"\");\n        }\n      },\n      \"json\"\n    );\n    return true;\n  });\n\n  $(document).on(\"click\", \".dir-name\", function () {\n    $(\"#button-newfolder\").attr(\"disabled\", true);\n    var name = \"\";\n    var fname = \"\";\n    name = $(this).html();\n    g_current_dir = name;\n\n    $(\"#tbody-saved-dirs tr.tr-up\").css(\"display\", \"block\");\n    $(\"#tbody-template-dir tr.tr-up\").css(\"display\", \"block\");\n\n    $(\"#tbody-template-dir tr.tr-file\").remove();\n    $(\"#tbody-template-file tr.tr-file\").remove();\n    $(\"#tbody-saved-dirs tr.tr-file\").remove();\n    $(\"#tbody-saved-files tr.tr-file\").remove();\n    $(\"#tbody-saved-files tr.tr-file\").remove();\n    for (var id in g_template_names) {\n      var t_name = g_template_names[id];\n      if (t_name.startsWith(name + \"/\")) {\n        fname = t_name.split(\"/\")[1];\n        insertFileItem_js(\"file\", id, fname, \"close\");\n        insertFileItem_js(\"file\", id, fname, \"\");\n      }\n    }\n    return true;\n  });\n\n  $(document).on(\"click\", \".dir-up\", function () {\n    $(\"#button-newfolder\").attr(\"disabled\", false);\n    $(\"#tbody-saved-dirs tr.tr-up\").css(\"display\", \"none\");\n    $(\"#tbody-template-dir tr.tr-up\").css(\"display\", \"none\");\n    g_current_dir = \"\";\n    initFileList_js();\n    return true;\n  });\n\n  $(document).on(\"click\", \".delete-section\", function () {\n    $(this)\n      .parents(\".div-section\")\n      .map(function () {\n        $(this).css(\"display\", \"none\");\n        $(this).find(\".field-value\").val(\"\");\n        $(this).find(\".field-value\").remove();\n        // $(this).remove();\n      });\n\n    var id = $(this).attr(\"id\");\n    var car_type = id.split(\"-\")[1];\n    var type = g_type_atoi[car_type];\n\n    car_type = car_type[0];\n\n    for (field_id in currentObject[\"fields\"]) {\n      if (currentObject[\"fields\"][field_id][\"cars_or_bikes\"] == car_type) {\n        if (currentObject[\"fields\"][field_id][\"status\"] == \"add\") {\n          currentObject[\"fields\"][field_id][\"status\"] = \"ignore\";\n        } else if (currentObject[\"fields\"][field_id][\"status\"] != \"ignore\") {\n          currentObject[\"fields\"][field_id][\"status\"] = \"delete\";\n        }\n      }\n    }\n    // if (currentObject[\"cars\"][type][\"status\"] == \"add\") {\n    //     currentObject[\"cars\"][type][\"status\"] = \"ignore\";\n    //   } else {\n    //     currentObject[\"cars\"][type][\"status\"] = \"delete\";\n    //   }\n    if (currentObject[\"status\"] != \"add\") {\n      currentObject[\"status\"] = \"update\";\n    }\n    // g_is_new = false;\n    template_status = \"update\";\n    return false;\n  });\n\n  var field_value;\n  $(document).on(\"click\", \".insert-field-value\", function () {\n    field_value = $(this).parents(\".tr-field\").find(\".field-name\").val();\n    insertFieldValue(field_value);\n  });\n\n  $(document).on(\"click\", \".delete-field\", function () {\n    var id = $(this).attr(\"id\");\n    var ar = id.split(\"-\");\n\n    if (ar.length < 2) {\n      $(\"#dialog-alert\").css(\"display\", \"block\");\n      return false;\n    }\n\n    var field_id = ar[2];\n\n    $(this)\n      .parents(\".tr-field\")\n      .map(function () {\n        $(this).remove();\n      });\n\n    if (currentObject[\"fields\"][field_id][\"status\"] == \"add\") {\n      currentObject[\"fields\"][field_id][\"status\"] = \"ignore\";\n    } else {\n      currentObject[\"fields\"][field_id][\"status\"] = \"delete\";\n    }\n\n    if (currentObject[\"status\"] != \"add\") {\n      currentObject[\"status\"] = \"update\";\n    }\n    template_status = \"update\";\n    return false;\n  });\n\n  $(document).on(\"click\", \".add-field\", function () {\n    max_car_value_id++;\n    max_field_id++;\n    var id = $(this).attr(\"id\");\n    var car_type = id.split(\"-\")[2];\n    var field_title = \"new_field\";\n    var type = g_type_atoi[car_type];\n\n    insertField_js(type, max_field_id, field_title);\n    var field_id = max_field_id;\n\n    currentObject[\"fields\"][field_id] = {};\n    currentObject[\"fields\"][field_id][\"id\"] = -1;\n    currentObject[\"fields\"][field_id][\"fields\"] = field_title;\n    currentObject[\"fields\"][field_id][\"cars_or_bikes\"] = car_type[0];\n    currentObject[\"fields\"][field_id][\"is_default\"] = \"0\";\n    currentObject[\"fields\"][field_id][\"status\"] = \"add\";\n\n    if (currentObject[\"status\"] != \"add\") {\n      currentObject[\"status\"] = \"update\";\n    }\n\n    return true;\n  });\n\n  $(document).on(\"change\", \".field-value\", function () {\n    var id = $(this).attr(\"id\");\n    var changed_value = $(this).val();\n    var ar = id.split(\"-\");\n\n    if (ar.length < 4) {\n      $(\"#dialog-alert\").css(\"display\", \"block\");\n      return false;\n    }\n    var value_id = ar[2];\n    var default_name = \"\";\n    $(this)\n      .parents(\"tbody\")\n      .map(function () {\n        $(this)\n          .find(\".field-name\")\n          .map(function () {\n            var name_id = $(this).attr(\"id\");\n            var name_ar = name_id.split(\"-\");\n\n            if (name_ar.length < 4) {\n              $(\"#dialog-alert\").css(\"display\", \"block\");\n              return false;\n            }\n            name_id = name_ar[2];\n            if (value_id != name_id) return;\n            var origin = $(this).val();\n            var pattern = /[a-zA-Z]+[a-zA-Z0-9_]+/g;\n            var field_name = origin.match(pattern);\n\n            for (var id in g_default_fields) {\n              if (field_name == g_default_fields[id][\"fields\"]) {\n                default_name = field_name;\n              }\n            }\n\n            if (default_name == \"\") {\n              return false;\n            }\n          });\n      });\n\n    $(this)\n      .parents(\".table-section\")\n      .map(function () {\n        var car_id = $(this).find(\".select\").val();\n        currentObject[\"cars\"][car_id][default_name] = changed_value;\n        if (currentObject[\"cars\"][car_id][\"status\"] != \"add\") {\n          currentObject[\"cars\"][car_id][\"status\"] = \"update\";\n        }\n      });\n\n    if (currentObject[\"status\"] != \"add\") {\n      currentObject[\"status\"] = \"update\";\n    }\n    return true;\n  });\n\n  $(document).on(\"focusout\", \".field-name\", function () {\n    var id = $(this).attr(\"id\");\n    var orign = $(this).val();\n    var ar = id.split(\"-\");\n\n    if (ar.length < 4) {\n      $(\"#dialog-alert\").css(\"display\", \"block\");\n      return false;\n    }\n\n    var field_view_name;\n    var field_id = ar[2];\n    var pattern = /[a-zA-Z]+[a-zA-Z0-9_]+/g;\n    var field_name = orign.match(pattern);\n    // updateStatus(\"focusout.field-name : \" + field_name);\n    for (var i in g_default_fields) {\n      if (field_name == g_default_fields[i][\"fields\"]) {\n        return false;\n      }\n    }\n\n    // if (field_id in currentObject[\"fields\"] && !(field_id in g_default_fields)) {\n    // } else {\n    //   return false;\n    // }\n    field_name = field_name[0];\n    if (ar[3] == \"car\") field_view_name = \"[#1_\" + field_name + \"]\";\n    else field_view_name = \"[#2_\" + field_name + \"]\";\n\n    $(this).val(field_view_name);\n    if (currentObject[\"fields\"][field_id][\"fields\"] == field_name) return false;\n\n    currentObject[\"fields\"][field_id][\"fields\"] = field_name;\n\n    if (currentObject[\"fields\"][field_id][\"id\"] != -1) {\n      currentObject[\"fields\"][field_id][\"status\"] = \"update\";\n    }\n\n    if (currentObject[\"status\"] != \"add\") {\n      currentObject[\"status\"] = \"update\";\n    }\n    return true;\n  });\n\n  $(document).on(\"focus\", \".field-name\", function () {\n    var id = $(this).attr(\"id\");\n    var origin = $(this).val();\n    var ar = id.split(\"-\");\n    if (ar.length < 4) {\n      $(\"#dialog-alert\").css(\"display\", \"block\");\n      return false;\n    }\n\n    var pattern = /[a-zA-Z]+[a-zA-Z0-9_]+/g;\n    var field_name = origin.match(pattern);\n    for (var i in g_default_fields) {\n      if (field_name == g_default_fields[i][\"fields\"]) {\n        return false;\n      }\n    }\n    $(this).val(field_name);\n\n    // if (field_id in currentObject[\"fields\"] && !(field_id in g_default_fields)) {\n    //   field_name = currentObject[\"fields\"][field_id][\"fields\"];\n    // } else {\n    //   return false;\n    // }\n    return true;\n  });\n\n  $(document).on(\"change\", \".select\", function () {\n    var id = $(this).attr(\"id\");\n    g_car_id = $(this).val();\n    var ar = id.split(\"-\");\n    var select_dom = $(this);\n    var default_name = \"\";\n    var myVar;\n    myVar = setTimeout(function () {\n      g_server_token = \"\";\n      g_token = \"\";\n      $(\"#table-setting-success\").css(\"display\", \"none\");\n      $(\"#table-setting\").css(\"display\", \"block\");\n\n      $(\"#button-connect\").html(\"Connect\");\n      // $(\"#button-connect\").css(\"width\", \"120px\");\n      // $(\"#button-connect\").css(\"height\", \"40px\");\n      alarm(\"Can't connect to Server\", \"\");\n      $(\"#div-alarm\").css(\"color\", \"red\");\n    }, 2000);\n    $.get(\n      gval.serverURI + \"?car=\" + g_car_id + g_token,\n      {},\n      function (data) {\n        clearTimeout(myVar);\n        jsonObject = {};\n        jsonObject = data;\n\n        if (ar.length < 2) {\n          $(\"#dialog-alert\").css(\"display\", \"block\");\n          return false;\n        }\n\n        currentObject[\"cars\"][g_car_id] = {};\n        currentObject[\"cars\"][g_car_id] = jsonObject;\n        // get field name;\n        var father;\n        var sel_id;\n        $(select_dom)\n          .parents(\".div-section\")\n          .map(function () {\n            var father = $(this);\n            $(this)\n              .find(\".field-name\")\n              .map(function () {\n                // father = $(this).parent()[0];\n                ar = $(this).attr(\"id\").split(\"-\");\n                sel_id = ar[2];\n\n                var origin = $(this).val();\n                var pattern = /[a-zA-Z]+[a-zA-Z0-9_]+/g;\n                var field_name = origin.match(pattern);\n                default_name = \"\";\n                for (var i in g_default_fields) {\n                  if (field_name == g_default_fields[i][\"fields\"]) {\n                    default_name = field_name;\n                    break;\n                  }\n                }\n                if (default_name == \"\") {\n                  return false;\n                }\n\n                father.find(\".field-value\").map(function () {\n                  var val_id = $(this).attr(\"id\");\n                  val_id = $(this).attr(\"id\").split(\"-\")[2];\n                  if (sel_id == val_id) {\n                    $(this).val(jsonObject[default_name]);\n                  }\n                });\n              });\n          });\n      },\n      \"json\"\n    );\n  });\n\n  $(\"#button-insert-motorbike\").click(function () {\n    if ($(\"#div-section-bike\").css(\"display\") == \"none\") {\n      $(\"#div-section-bike\").css(\"display\", \"block\");\n      if ($(\"#div-section-car\").css(\"display\") != \"none\") $(\"#separator\").css(\"display\", \"block\");\n      g_is_new = true;\n      insertSection_js(2);\n      g_is_new = false;\n    } else {\n      // g_cc_type = 2;\n      // $(\"#dialog-car-name\").css(\"display\", \"block\");\n    }\n    // console.log(\"button-insert-motorbike currentObject:\\n\", currentObject);\n  });\n\n  $(\"#button-insert-car\").click(function () {\n    if ($(\"#div-section-car\").css(\"display\") == \"none\") {\n      $(\"#div-section-car\").css(\"display\", \"block\");\n      g_is_new = true;\n      insertSection_js(1);\n      g_is_new = false;\n    } else {\n      // g_cc_type = 1;\n      // $(\"#dialog-car-name\").css(\"display\", \"block\");\n    }\n    // console.log(\"button-insert-car currentObject:\\n\", currentObject);\n  });\n\n  $(\"#button-save-carname\").click(function () {\n    var car_name = $(\"#input-new-car-name\").val();\n    $(\"#dialog-car-name\").css(\"display\", \"none\");\n\n    var t;\n    if (g_cc_type == 1) t = \"c\";\n    else t = \"b\";\n\n    for (var i in currentObject[\"fields\"]) {\n      if (currentObject[\"fields\"][i][\"cars_or_bikes\"] == t) {\n        delete currentObject[\"fields\"][i];\n      }\n    }\n    // g_is_new = true;\n    insertSection_js(g_cc_type);\n    // g_is_new = false;\n    // max_car_id++;\n    carOptions += '<option value=\"' + max_car_id + '\">' + car_name + \"</option>\";\n    document.getElementById(\"select-car\").innerHTML = carOptions;\n    document.getElementById(\"select-bike\").innerHTML = carOptions;\n    currentObject[\"cars\"][max_car_id][\"title\"] = car_name; // get title\n    currentObject[\"cars\"][max_car_id][\"status\"] = \"add\";\n    $(\".select\").val(max_car_id);\n  });\n\n  $(\"#button-cancel-carname\").click(function () {\n    $(\"#dialog-car-name\").css(\"display\", \"none\");\n  });\n\n  $(\"#button-fillout\").click(function () {\n    // $(\".tr-field\").map(function () {\n    //   var key = $(this).find(\".field-name\").val();\n    //   var value = $(this).find(\".field-value\").val();\n    //   replaceWordText(key, value);\n    // });\n    // $(function () {\n    // });\n  });\n\n  $(\"#button-reset\").click(function () {\n    // $(function () {\n    //   $(\".field-value\").map(function () {\n    //     $(this).val(\"\");\n    //   });\n    // });\n    insertTemplates();\n  });\n\n  $(document).on(\"click\", \"#select-template\", function (event) {\n    if ($(\"#select-template option\").length < 2 && $(this).val().startsWith(\"..\")) {\n      g_current_dir_option = \"\";\n      initTemplate_js();\n    } else if (currentObject[\"status\"] == \"update\") {\n      event.stopPropagation();\n      $(\"#dialog-save-confirm\").dialog(\"open\");\n      // sendFile();\n    }\n    return true;\n  });\n\n  $(document).on(\"input\", \"#save-doc-name\", function (event) {\n    var value = $(this).val();\n    for (var i in g_template_names) {\n      if (value == g_template_names[i]) {\n        $(this).css(\"border-color\", \"red\");\n        return true;\n      } else {\n        //$(\"#name-alarm\").innerHTML(\"\");\n      }\n    }\n    $(this).css(\"border-color\", \"black\");\n    return true;\n  });\n});\n\nfunction insertField_js(type, id, fd_name, readonly = 0) {\n  var str_type = { 1: \"car\", 2: \"bike\" };\n  var id_suffix = id + \"-\" + str_type[type];\n  var fd_name_value = \"[#\" + type + \"_\" + fd_name + \"]\";\n  var closeButton = \"\";\n  if (readonly == 1) {\n    readonly = \"readonly\";\n  } else {\n    readonly = \"\";\n    closeButton = \"<img src='../../assets/close.png' alt='' class='delete-field' id='delete-field-\" + id + \"'/>\";\n  }\n\n  var tr_field =\n    \"   <tr class='tr-field'> \\\n      <td><table width='100%'> \\\n      <tbody> \\\n        <tr> \\\n        <td width='6%'><img  src='../../assets/arrow-left.png' alt='' class='insert-field-value'/></td> \\\n        <td><input name='field-name' type='text' class='field-name' id = 'field-name-\" +\n    id_suffix +\n    \"' value='\" +\n    fd_name_value +\n    \"' \" +\n    readonly +\n    \"></td> \\\n        <td width='6%' align='right'>\" +\n    closeButton +\n    \"</td> \\\n        </tr> \\\n        <tr> \\\n        <td colspan='3'> \\\n          <input name='textfield2' type='text' class='field-value' id='field-value-\" +\n    id_suffix +\n    \"'> \\\n          </td> \\\n        </tr> \\\n        </tbody> \\\n      </table></td> \\\n    </tr>\";\n\n  if (type == 1) {\n    $(\"#tbody-field-car\").append(tr_field);\n  } else {\n    $(\"#tbody-field-bike\").append(tr_field);\n  }\n}\n\nfunction insertSection_js(type) {\n  var today = new Date();\n  var date = today.getFullYear() + \"-\" + (today.getMonth() + 1) + \"-\" + today.getDate();\n  var time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n  var dateTime = date + \" \" + time;\n  max_car_id++;\n  // console.log(\"insertSection_js -------- g_is_new:\\n\", g_is_new);\n  if (!g_is_new) {\n    currentObject[\"cars\"][max_car_id] = {};\n    currentObject[\"cars\"][max_car_id][\"id\"] = -1;\n    currentObject[\"cars\"][max_car_id][\"title\"] = \"\"; // get title\n    currentObject[\"cars\"][max_car_id][\"brand\"] = \"\"; // get title\n    currentObject[\"cars\"][max_car_id][\"year\"] = \"\"; // get title\n  }\n\n  if (type == 1) {\n    $(\"#tbody-field-car .tr-field\").remove();\n  } else {\n    $(\"#tbody-field-bike .tr-field\").remove();\n  }\n\n  for (var id in g_default_fields) {\n    if (g_default_fields[id][\"cars_or_bikes\"] == \"c\" && type != 1) continue;\n    else if (g_default_fields[id][\"cars_or_bikes\"] == \"b\" && type != 2) continue;\n    // console.log(\"g_default_fields's type:\", g_default_fields[id][\"cars_or_bikes\"]);\n\n    max_field_id++;\n    var fd_name = g_default_fields[id][\"fields\"];\n    // updateStatus(\"insertSection----type, id, fd_name: \" + type + \" \" + id + \" \" + fd_name);\n    insertField_js(type, id, fd_name, 1);\n    currentObject[\"fields\"][max_field_id] = {};\n    currentObject[\"fields\"][max_field_id][\"id\"] = -1;\n    currentObject[\"fields\"][max_field_id][\"fields\"] = g_default_fields[id][\"fields\"];\n    currentObject[\"fields\"][max_field_id][\"cars_or_bikes\"] = g_default_fields[id][\"cars_or_bikes\"];\n    currentObject[\"fields\"][max_field_id][\"is_default\"] = \"1\";\n    currentObject[\"fields\"][max_field_id][\"status\"] = \"add\";\n    if (currentObject[\"status\"] != \"add\") {\n      currentObject[\"status\"] = \"update\";\n    }\n  }\n}\n\nfunction insertFileItem_js(type, id, name, readonly) {\n  // type : file or dir\n  // readonly : close or empty\n  var closeButton = \"\";\n  var copyButton = \"\";\n  var icon = \"\";\n  var td_name = \"\";\n  if (readonly == \"close\") {\n    closeButton =\n      \"<td width='10%'><img src='../../assets/close.png' alt='' class='file-delete' id='delete-\" +\n      type +\n      \"-\" +\n      id +\n      \"'/></td>\";\n    copyButton =\n      \"<td width='10%'><img src='../../assets/copy.png' alt='' class='copy-doc' id='copy-file-\" + id + \"'/></td>\";\n  }\n\n  var tr_field;\n  if (type == \"dir\") {\n    icon = '<td width=\"10%\"><img src=\"../../assets/folder.png\" alt=\"\" class=\"icon-folder\"/></td>';\n    copyButton = \"<td width='10%'>&nbsp;</td>\";\n    td_name = '<td class=\"dir-name\">' + name + \"</td>\";\n  } else {\n    icon = '<td width=\"10%\">&nbsp;</td>';\n    td_name = '<td class=\"file-name\">' + name + \"</td>\";\n  }\n\n  if (readonly == \"close\") {\n    tr_field = '<tr class=\"tr-file\">' + icon + td_name + copyButton + closeButton + \"</tr>\";\n  } else {\n    if (type == \"file\") {\n      tr_field = '<tr class=\"tr-file\" id=\"tr-file-' + id + '\">' + icon + td_name + copyButton + closeButton + \"</tr>\";\n    } else {\n      tr_field = '<tr class=\"tr-file\" id=\"tr-dir-' + id + '\">' + icon + td_name + copyButton + closeButton + \"</tr>\";\n    }\n  }\n\n  if (type == \"file\") {\n    if (readonly == \"close\") $(\"#tbody-template-file\").append(tr_field);\n    else $(\"#tbody-saved-files\").append(tr_field);\n  } else {\n    if (readonly == \"close\") $(\"#tbody-template-dir\").append(tr_field);\n    else $(\"#tbody-saved-dirs\").append(tr_field);\n  }\n}\n\nfunction initFileList_js() {\n  // console.log(\"insertSection_js -------- g_is_new:\\n\", g_is_new);\n  $(\"#tbody-template-dir tr.tr-file\").remove();\n  $(\"#tbody-template-file tr.tr-file\").remove();\n  $(\"#tbody-saved-dirs tr.tr-file\").remove();\n  $(\"#tbody-saved-files tr.tr-file\").remove();\n\n  var id;\n  for (id in g_dir_names) {\n    insertFileItem_js(\"dir\", id, g_dir_names[id], \"close\");\n    insertFileItem_js(\"dir\", id, g_dir_names[id], \"\");\n  }\n\n  for (id in g_template_names) {\n    if (g_template_names[id].split(\"/\").length == 1) {\n      insertFileItem_js(\"file\", id, g_template_names[id], \"close\");\n      insertFileItem_js(\"file\", id, g_template_names[id], \"\");\n    }\n  }\n}\n\nfunction updateStatus(message, act = \"add\") {\n  var statusInfo = $(\"#status\");\n  if (act != \"add\") statusInfo[0].innerHTML = message + \"<br/>\";\n  else statusInfo[0].innerHTML += message + \"<br/>\";\n}\n\nfunction alarm(message, act = \"add\") {\n  var statusInfo = $(\"#div-alarm\");\n  if (act != \"add\") statusInfo[0].innerHTML = message + \"<br/>\";\n  else statusInfo[0].innerHTML += message + \"<br/>\";\n}\n\nfunction initTemplate_js() {\n  updateStatus(\"kcg=1223p\");\n  var myVar;\n  // var jsonObject = {};\n  // myVar = setTimeout(function () {\n  //   g_server_token = \"\";\n  //   g_token = \"\";\n  //   $(\"#table-setting-success\").css(\"display\", \"none\");\n  //   $(\"#table-setting\").css(\"display\", \"block\");\n\n  //   $(\"#button-connect\").html(\"Connect\");\n  //   // $(\"#button-connect\").css(\"width\", \"120px\");\n  //   // $(\"#button-connect\").css(\"height\", \"40px\");\n  //   alarm(\"Can't connect to Server\", \"\");\n  //   $(\"#div-alarm\").css(\"color\", \"red\");\n  // }, 2000);\n\n  updateStatus(\"kcg=p\");\n  $.get(\n    gval.serverURI + \"?templates\" + g_token,\n    {},\n    function (data) {\n      updateStatus(\"kcg=1111\");updateStatus(\"kcg=222\");\n      // clearTimeout(myVar);\n      if (data[\"status\"] != \"success\") return;\n      jsonObject = {};\n      jsonObject = data;\n      // console.log(\"initTemplate jsonObject:\\n\", jsonObject);\n      // g_default_fields = {};\n      // g_dir_names = {};\n      // g_template_names = {}; \n      g_default_fields = jsonObject[\"fields\"];\n      // updateStatus(\"--------g_default_fields:\" + JSON.stringify(g_default_fields));\n\n      templateOptions = \"<option value=''>Select a template</option>\";\n      // updateStatus(JSON.stringify(jsonObject[\"templates\"]));\n      g_dir_names = jsonObject[\"dirs\"];\n\n      for (var id in g_dir_names) {\n        templateOptions += \"<option>[\" + g_dir_names[id] + \"]</option>\";\n      }\n      // updateStatus(\"initTemplate------\\n\" + JSON.stringify(jsonObject));\n      var i;\n      for (var ii in jsonObject[\"templates\"]) {\n        i = jsonObject[\"templates\"][ii][\"id\"];\n        g_template_names[i] = jsonObject[\"templates\"][ii][\"file_name\"];\n\n        if (g_template_names[i].search(\"/\") < 0) {\n          templateOptions =\n            templateOptions + '<option value=\"' + i + '\">' + jsonObject[\"templates\"][ii][\"file_name\"] + \"</option>\";\n        }\n      }\n      // updateStatus(\"initTemplate_js array: \" + g_template_names);\n\n      g_template_id = 0;\n      document.getElementById(\"select-template\").innerHTML = templateOptions;\n      $(\"#table-setting-success\").css(\"display\", \"block\");\n      $(\"#table-setting\").css(\"display\", \"none\");\n\n      $(\"#button-connect\").html(\"Disconnect\");\n      // $(\"#button-connect\").css(\"width\", \"120px\");\n      // $(\"#button-connect\").css(\"height\", \"40px\");\n\n      currentObject = {};\n      currentObject[\"buf\"] = \"\";\n      currentObject[\"id\"] = -1;\n      currentObject[\"fname\"] = \"\";\n      currentObject[\"date\"] = \"\";\n      currentObject[\"buf\"] = \"\";\n      currentObject[\"cars\"] = {};\n      currentObject[\"fields\"] = {};\n\n      initFileList_js();\n      // console.log(\"initTemplate g_default_fields:\\n\", g_default_fields);\n      // updateStatus(\" init template SUCCESS!!! \");\n    },\n    \"json\"\n  );\n}\n\nfunction initCars_js() {\n  var myVar;\n  myVar = setTimeout(function () {\n    g_server_token = \"\";\n    g_token = \"\";\n    $(\"#table-setting-success\").css(\"display\", \"none\");\n    $(\"#table-setting\").css(\"display\", \"block\");\n\n    $(\"#button-connect\").html(\"Connect\");\n    // $(\"#button-connect\").css(\"width\", \"120px\");\n    // $(\"#button-connect\").css(\"height\", \"40px\");\n    alarm(\"Can't connect to Server\", \"\");\n    $(\"#div-alarm\").css(\"color\", \"red\");\n  }, 2000);\n\n  $.get(\n    gval.serverURI + \"?cars\" + g_token,\n    {},\n    function (data) {\n      clearTimeout(myVar);\n      jsonObject = {};\n      jsonObject = data; // JSON.parse(data);\n\n      carOptions = \"<option value=''>Select a car</option>\";\n      for (var i in jsonObject) {\n        carOptions = carOptions + '<option value=\"' + i + '\">' + jsonObject[i] + \"</option>\";\n        if (max_car_id < eval(i)) max_car_id = eval(i);\n      }\n\n      g_template_id = 0;\n      document.getElementById(\"select-car\").innerHTML = carOptions;\n      document.getElementById(\"select-bike\").innerHTML = carOptions;\n    },\n    \"json\"\n  );\n}\n\nfunction initUI() {\n  $(\".tr-field\").map(function () {\n    $(this).remove();\n  });\n  $(\"#div-section-car\").css(\"display\", \"none\");\n  $(\"#div-section-bike\").css(\"display\", \"none\");\n  $(\"#separator\").css(\"display\", \"none\");\n}\n\n$(document).ready(function () {\n  // initTemplate_js();\n  // initCars_js();\n  // initUI();\n  g_client_token = generate_token(32);\n  $(\"#new-token\").val(g_client_token);\n\n  document.getElementById(\"app-body\").style.display = \"flex\";\n  // document.getElementById(\"select-template\").onchange = insertTemplates;\n  document.getElementById(\"select-template\").onchange = changeTemplate_js;\n});\n\n// create fields\nfunction changeTemplate_js(event) {\n  $(\"#button-fillout\").removeAttr(\"disabled\");\n  $(\"#button-reset\").removeAttr(\"disabled\");\n  var e = document.getElementById(\"select-template\");\n  var pattern = /[a-zA-Z_\\s]+/g;\n  var origin = e.value;\n  var dir_name = origin.match(pattern);\n\n  if (origin.endsWith(\".docx\") < 0) g_current_dir_option = dir_name;\n  else g_current_dir_option = \"\";\n  if (e.value.startsWith(\"[\") == true) {\n    templateOptions = \"<option>../[\" + dir_name + \"]</option>\";\n    for (var i in g_template_names) {\n      if (g_template_names[i].startsWith(dir_name + \"/\") && g_template_names[i].split(\"/\")[1]) {\n        templateOptions += '<option value=\"' + i + '\">' + g_template_names[i].split(\"/\")[1] + \"</option>\";\n      }\n    }\n    event.stopPropagation();\n    document.getElementById(\"select-template\").innerHTML = templateOptions;\n  } else if (e.value.startsWith(\"..\") == true) {\n    g_current_dir_option = \"\";\n    event.stopPropagation();\n    initTemplate_js();\n  }\n\n  g_template_id = eval(e.value);\n  g_fname = e.options[e.selectedIndex].text;\n  $(\"#save-doc-name\").val(g_fname);\n  g_new_template = 0;\n  currentObject[\"id\"] = g_template_id;\n  currentObject[\"fname\"] = g_fname;\n  currentObject[\"cars\"] = {};\n  var myVar;\n  myVar = setTimeout(function () {\n    g_server_token = \"\";\n    g_token = \"\";\n    $(\"#table-setting-success\").css(\"display\", \"none\");\n    $(\"#table-setting\").css(\"display\", \"block\");\n\n    $(\"#button-connect\").html(\"Connect\");\n    // $(\"#button-connect\").css(\"width\", \"120px\");\n    // $(\"#button-connect\").css(\"height\", \"40px\");\n    alarm(\"Can't connect to Server\", \"\");\n    $(\"#div-alarm\").css(\"color\", \"red\");\n  }, 2000);\n  $.get(\n    gval.serverURI + \"?template=\" + g_template_id + g_token,\n    {},\n    function (data) {\n      clearTimeout(myVar);\n      jsonObject = {};\n      jsonObject = data; // JSON.parse(data);\n      currentObject[\"fields\"] = jsonObject[\"fields\"];\n      currentObject[\"buf\"] = jsonObject[\"buf\"];\n      currentObject[\"status\"] = \"\";\n\n      insertTemplates();\n\n      $(\".tr-field\").map(function () {\n        $(this).remove();\n      });\n\n      max_field_id = 1;\n      for (var id in jsonObject[\"fields\"]) {\n        var type = jsonObject[\"fields\"][id][\"cars_or_bikes\"];\n        var field_name = jsonObject[\"fields\"][id][\"fields\"];\n        var is_default = jsonObject[\"fields\"][id][\"is_default\"];\n        if (id > max_field_id) max_field_id = id;\n        if (type == \"c\") {\n          type = 1;\n          $(\"#div-section-car\").css(\"display\", \"block\");\n        } else {\n          type = 2;\n          $(\"#div-section-bike\").css(\"display\", \"block\");\n          if ($(\"#div-section-car\").css(\"display\") != \"none\") $(\"#separator\").css(\"display\", \"block\");\n        }\n\n        var readOnly = 0;\n        for (var d_id in g_default_fields) {\n          if (field_name == g_default_fields[d_id][\"fields\"]) {\n            readOnly = 1;\n          }\n        }\n        // if (id in g_default_fields) readOnly = 1;\n\n        // updateStatus(\"changeTemplate-------field_name : \" + field_name);\n        // for (var default_id in g_default_fields) {\n        //   // updateStatus(\"changeTemplate-------default id : \" + default_id);\n        //   // updateStatus(\"changeTemplate-------name : \" + g_default_fields[default_id][\"fields\"]);\n        //   // if (field_name == g_default_fields[default_id][\"fields\"]) id = default_id;\n        // }\n\n        insertField_js(type, id, field_name, is_default);\n      }\n    },\n    \"json\"\n  );\n}\n\nfunction generate_token(length) {\n  //edit the token allowed characters\n  var a = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890\".split(\"\");\n  var b = [];\n  for (var i = 0; i < length; i++) {\n    var j = (Math.random() * (a.length - 1)).toFixed(0);\n    b[i] = a[j];\n  }\n  return b.join(\"\");\n}\n\nfunction getToken() {\n  if (g_connected) {\n    g_token = \"&stoken=\" + g_client_token + \"&ptoken=\" + g_server_token;\n  }\n  return g_token;\n}\n\nfunction replaceWordText(key, value) {\n  Word.run(function (context) {\n    // Queue a command to search the document and ignore punctuation.\n    var searchResults = context.document.body.search(key, { ignorePunct: true });\n    context.load(searchResults);\n\n    return context.sync().then(function () {\n      for (var i = 0; i < searchResults.items.length; i++) {\n        searchResults.items[i].insertText(value, Word.InsertLocation.replace);\n      }\n\n      return context.sync();\n    });\n  });\n}\n\nOffice.onReady((info) => {\n  if (info.host === Office.HostType.Word) {\n    // Determine if the user's version of Office supports all the Office.js APIs that are used in the tutorial.\n    if (!Office.context.requirements.isSetSupported(\"WordApi\", \"1.3\")) {\n      // eslint-disable-next-line no-undef\n      // console.log(\"Sorry. The tutorial add-in uses Word.js APIs that are not available in your version of Office.\");\n    }\n\n    //context\n    // document.getElementById(\"select-template\").innerHTML = templateOptions;\n\n    // Assign event handlers and other initialization logic.\n\n    //my actions\n    // jquery function uesed\n    // $(document).ready(function () {});\n  }\n});\n\n//OK good down file to base64\n// $.post( gval.serverURI, {fpath:\"template2.docx\"}, function( data ) {\n//   // updateStatus(\"RECVDATA initSet success !!!!\");\n//   context.document.body.insertFileFromBase64(data.replace(/^.+,/, \"\"), Word.InsertLocation.replace);\n// });\n\nfunction sendFile() {\n  // updateStatus(\"send File called\");\n  // // console.log(\"sendFile currentObject:\\n\", currentObject);\n  Office.context.document.getFileAsync(\"compressed\", { sliceSize: 100000 }, function (result) {\n    if (result.status == Office.AsyncResultStatus.Succeeded) {\n      // Get the File object from the result.\n      var myFile = result.value;\n      var state = {\n        file: myFile,\n        counter: 0,\n        sliceCount: myFile.sliceCount,\n      };\n      getSlice(state);\n    } else {\n      // updateStatus(result.status);\n    }\n  });\n}\n\nfunction getSlice(state) {\n  state.file.getSliceAsync(state.counter, function (result) {\n    if (result.status == Office.AsyncResultStatus.Succeeded) {\n      sendSlice(result.value, state);\n    } else {\n      // updateStatus(result.status);\n    }\n  });\n}\n\nfunction sendSlice(slice, state) {\n  var data = slice.data;\n  if (data) {\n    var buf = btoa(data);\n    closeFile(state);\n\n    var today = new Date();\n    var date = today.getFullYear() + \"-\" + (today.getMonth() + 1) + \"-\" + today.getDate();\n    var time = today.getHours() + \":\" + today.getMinutes() + \":\" + today.getSeconds();\n    var dateTime = date + \" \" + time;\n\n    currentObject[\"date\"] = dateTime;\n    currentObject[\"buf\"] = \"\";\n    // updateStatus(\"----Sending file-->\");\n    // updateStatus(\"send:\");\n    //updateStatus(JSON.stringify(currentObject));\n\n    var myVar;\n    myVar = setTimeout(function () {\n      g_server_token = \"\";\n      g_token = \"\";\n      $(\"#table-setting-success\").css(\"display\", \"none\");\n      $(\"#table-setting\").css(\"display\", \"block\");\n\n      $(\"#button-connect\").html(\"Connect\");\n      // $(\"#button-connect\").css(\"width\", \"120px\");\n      // $(\"#button-connect\").css(\"height\", \"40px\");\n      alarm(\"Can't connect to Server\", \"\");\n      $(\"#div-alarm\").css(\"color\", \"red\");\n    }, 2000);\n\n    currentObject[\"buf\"] = buf;\n    $.post(\n      gval.serverURI,\n      { template_save: JSON.stringify(currentObject), stoken: g_client_token, ptoken: g_server_token },\n      function (returnData) {\n        clearTimeout(myVar);\n        if (returnData[\"status\"] == \"success\") {\n          // updateStatus(JSON.stringify(currentObject));\n          // updateStatus(\"<br><br><br>\");\n          currentObject[\"status\"] = \"\";\n          initTemplate_js();\n          initCars_js();\n          initUI();\n        } else {\n          // updateStatus(\" ::error : \" + returnData[\"buf\"]);\n        }\n      },\n      \"json\"\n    );\n  }\n}\n\nfunction closeFile(state) {\n  state.file.closeAsync(function (result) {\n    // eslint-disable-next-line no-empty\n    if (result.status == \"succeeded\") {\n    } else {\n      // updateStatus(\"File couldn't be closed.\");\n    }\n  });\n}\n\nfunction insertTemplates() {\n  Word.run(function (context) {\n    // changeTemplate_js();\n    // document.getElementById(\"invisible\").style.visibility = \"visible\";\n\n    context.document.body.insertFileFromBase64(currentObject[\"buf\"], Word.InsertLocation.replace);\n    return context.sync();\n  });\n}\n\nfunction insertFieldValue(value) {\n  Word.run(function (context) {\n    // console.log(\"addField clicked.\");\n    var currentSelection = context.document.getSelection();\n    currentSelection.clear();\n    currentSelection.insertText(\" \" + value, Word.InsertLocation.start);\n\n    return context.sync();\n  }).catch(function (error) {\n    // eslint-disable-next-line no-undef\n    // console.log(\"Error: \" + error);\n    if (error instanceof OfficeExtension.Error) {\n      // console.log(\"Debug info: \" + JSON.stringify(error.debugInfo));\n    }\n  });\n}\n"],"names":["templateOptions","carOptions","productListOptions","productTextsOptions","i","proId","downfilesBuf","g_car_id","template_status","g_type_atoi","car","bike","months","jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","jsonObject","currentObject","g_template_id","g_fname","max_field_id","max_car_value_id","max_car_id","g_default_fields","g_template_names","g_dir_names","g_current_dir","g_current_dir_option","g_client_token","g_server_token","g_token","g_connected","g_cc_type","g_is_new","g_new_template","insertField_js","type","id","fd_name","readonly","str_type","id_suffix","fd_name_value","closeButton","tr_field","$","append","insertSection_js","today","Date","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","remove","insertFileItem_js","name","copyButton","icon","td_name","initFileList_js","split","length","updateStatus","message","act","statusInfo","innerHTML","alarm","initTemplate_js","get","gval","serverURI","data","ii","search","document","getElementById","css","html","initCars_js","myVar","setTimeout","clearTimeout","eval","initUI","map","this","changeTemplate_js","event","removeAttr","e","pattern","origin","value","dir_name","match","endsWith","startsWith","stopPropagation","options","selectedIndex","text","val","insertTemplates","field_name","is_default","d_id","generate_token","a","b","j","Math","random","toFixed","join","getToken","replaceWordText","key","Word","run","context","searchResults","body","ignorePunct","load","sync","then","items","insertText","InsertLocation","replace","sendFile","Office","getFileAsync","sliceSize","result","status","AsyncResultStatus","Succeeded","myFile","getSlice","file","counter","sliceCount","state","getSliceAsync","sendSlice","slice","buf","btoa","closeFile","dateTime","post","template_save","JSON","stringify","stoken","ptoken","returnData","closeAsync","insertFileFromBase64","insertFieldValue","currentSelection","getSelection","clear","start","catch","error","OfficeExtension","Error","window","click","target","attr","on","parent","req","max_id","eq","before","disconnect","doc_name","full_name","is_duplicate","row","children","last","prop","new_id","new_name","arr","Option","fname","t_name","parents","find","car_type","field_id","ar","field_title","changed_value","value_id","default_name","name_id","name_ar","car_id","field_view_name","orign","select_dom","sel_id","father","val_id","t","car_name","dialog","ready","style","display","onchange","onReady","info","host","HostType","requirements","isSetSupported"],"sourceRoot":""}