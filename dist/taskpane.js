(function(){var __webpack_exports__={},templateOptions="<option value=''>Select a template</option>",carOptions="<option value=''>Select a car</option>",productListOptions="<option value=''>Select product</option>",productTextsOptions="<option value=''>Select product text</option>",i,proId="",downfilesBuf=[],g_car_id=1,template_status="",g_type_atoi={car:1,bike:2},months={jan:0,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},jsonObject={},currentObject={},g_template_id=1,g_fname="template1.docx",max_field_id=1,max_car_value_id=1,max_car_id=1,g_default_fields={},g_template_names={},g_dir_names={},g_current_dir="",g_current_dir_option="",g_client_token,g_server_token="";g_token="";var g_connected=!1,g_cc_type=1,g_is_new=!1,g_new_template=0;function insertField_js(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i={1:"car",2:"bike"},a=t+"-"+i[e],c="[#"+e+"_"+n+"]",o="";1==s?s="readonly":(s="",o="<img src='../../assets/close.png' alt='' class='delete-field' id='delete-field-"+t+"'/>");var r="   <tr class='tr-field'>       <td><table width='100%'>       <tbody>         <tr>         <td width='6%'><img  src='../../assets/arrow-left.png' alt='' class='insert-field-value'/></td>         <td><input name='field-name' type='text' class='field-name' id = 'field-name-"+a+"' value='"+c+"' "+s+"></td>         <td width='6%' align='right'>"+o+"</td>         </tr>         <tr>         <td colspan='3'>           <input name='textfield2' type='text' class='field-value' id='field-value-"+a+"'>           </td>         </tr>         </tbody>       </table></td>     </tr>";1==e?$("#tbody-field-car").append(r):$("#tbody-field-bike").append(r)}function insertSection_js(e){var t=new Date;for(var n in t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),max_car_id++,g_is_new||(currentObject.cars[max_car_id]={},currentObject.cars[max_car_id].id=-1,currentObject.cars[max_car_id].title="",currentObject.cars[max_car_id].brand="",currentObject.cars[max_car_id].year=""),1==e?$("#tbody-field-car .tr-field").remove():$("#tbody-field-bike .tr-field").remove(),g_default_fields)"c"==g_default_fields[n].cars_or_bikes&&1!=e||"b"==g_default_fields[n].cars_or_bikes&&2!=e||(max_field_id++,insertField_js(e,n,g_default_fields[n].fields,1),currentObject.fields[max_field_id]={},currentObject.fields[max_field_id].id=-1,currentObject.fields[max_field_id].fields=g_default_fields[n].fields,currentObject.fields[max_field_id].cars_or_bikes=g_default_fields[n].cars_or_bikes,currentObject.fields[max_field_id].is_default="1",currentObject.fields[max_field_id].status="add","add"!=currentObject.status&&(currentObject.status="update"))}function insertFileItem_js(e,t,n,s){var i,a="",c="",o="",r="";"close"==s&&(a="<td width='10%'><img src='../../assets/close.png' alt='' class='file-delete' id='delete-"+e+"-"+t+"'/></td>",c="<td width='10%'><img src='../../assets/copy.png' alt='' class='copy-doc' id='copy-file-"+t+"'/></td>"),"dir"==e?(o='<td width="10%"><img src="../../assets/folder.png" alt="" class="icon-folder"/></td>',c="<td width='10%'>&nbsp;</td>",r='<td class="dir-name">'+n+"</td>"):(o='<td width="10%">&nbsp;</td>',r='<td class="file-name">'+n+"</td>"),i="close"==s?'<tr class="tr-file">'+o+r+c+a+"</tr>":"file"==e?'<tr class="tr-file" id="tr-file-'+t+'">'+o+r+c+a+"</tr>":'<tr class="tr-file" id="tr-dir-'+t+'">'+o+r+c+a+"</tr>","file"==e?"close"==s?$("#tbody-template-file").append(i):$("#tbody-saved-files").append(i):"close"==s?$("#tbody-template-dir").append(i):$("#tbody-saved-dirs").append(i)}function initFileList_js(){var e;for(e in $("#tbody-template-dir tr.tr-file").remove(),$("#tbody-template-file tr.tr-file").remove(),$("#tbody-saved-dirs tr.tr-file").remove(),$("#tbody-saved-files tr.tr-file").remove(),g_dir_names)insertFileItem_js("dir",e,g_dir_names[e],"close"),insertFileItem_js("dir",e,g_dir_names[e],"");for(e in g_template_names)1==g_template_names[e].split("/").length&&(insertFileItem_js("file",e,g_template_names[e],"close"),insertFileItem_js("file",e,g_template_names[e],""))}function updateStatus(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",n=$("#status");"add"!=t?n[0].innerHTML=e+"<br/>":n[0].innerHTML+=e+"<br/>"}function alarm(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",n=$("#div-alarm");"add"!=t?n[0].innerHTML=e+"<br/>":n[0].innerHTML+=e+"<br/>"}function initTemplate_js(){updateStatus("kcg=1223p"),updateStatus("kcg=p"),$.get(gval.serverURI+"?templates"+g_token,{},(function(e){if(updateStatus("kcg=1111"),updateStatus("kcg=222"),"success"==e.status){for(var t in jsonObject={},g_default_fields=(jsonObject=e).fields,templateOptions="<option value=''>Select a template</option>",g_dir_names=jsonObject.dirs)templateOptions+="<option>["+g_dir_names[t]+"]</option>";var n;for(var s in jsonObject.templates)n=jsonObject.templates[s].id,g_template_names[n]=jsonObject.templates[s].file_name,g_template_names[n].search("/")<0&&(templateOptions=templateOptions+'<option value="'+n+'">'+jsonObject.templates[s].file_name+"</option>");g_template_id=0,document.getElementById("select-template").innerHTML=templateOptions,$("#table-setting-success").css("display","block"),$("#table-setting").css("display","none"),$("#button-connect").html("Disconnect"),(currentObject={}).buf="",currentObject.id=-1,currentObject.fname="",currentObject.date="",currentObject.buf="",currentObject.cars={},currentObject.fields={},initFileList_js()}}),"json")}function initCars_js(){var myVar;myVar=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),$.get(gval.serverURI+"?cars"+g_token,{},(function(data){for(var i in clearTimeout(myVar),jsonObject={},jsonObject=data,carOptions="<option value=''>Select a car</option>",jsonObject)carOptions=carOptions+'<option value="'+i+'">'+jsonObject[i]+"</option>",max_car_id<eval(i)&&(max_car_id=eval(i));g_template_id=0,document.getElementById("select-car").innerHTML=carOptions,document.getElementById("select-bike").innerHTML=carOptions}),"json")}function initUI(){$(".tr-field").map((function(){$(this).remove()})),$("#div-section-car").css("display","none"),$("#div-section-bike").css("display","none"),$("#separator").css("display","none")}function changeTemplate_js(event){$("#button-fillout").removeAttr("disabled"),$("#button-reset").removeAttr("disabled");var e=document.getElementById("select-template"),pattern=/[a-zA-Z_\s]+/g,origin=e.value,dir_name=origin.match(pattern),myVar;if(g_current_dir_option=origin.endsWith(".docx")<0?dir_name:"",1==e.value.startsWith("[")){for(var i in templateOptions="<option>../["+dir_name+"]</option>",g_template_names)g_template_names[i].startsWith(dir_name+"/")&&g_template_names[i].split("/")[1]&&(templateOptions+='<option value="'+i+'">'+g_template_names[i].split("/")[1]+"</option>");event.stopPropagation(),document.getElementById("select-template").innerHTML=templateOptions}else 1==e.value.startsWith("..")&&(g_current_dir_option="",event.stopPropagation(),initTemplate_js());g_template_id=eval(e.value),g_fname=e.options[e.selectedIndex].text,$("#save-doc-name").val(g_fname),g_new_template=0,currentObject.id=g_template_id,currentObject.fname=g_fname,currentObject.cars={},myVar=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),$.get(gval.serverURI+"?template="+g_template_id+g_token,{},(function(e){for(var t in clearTimeout(myVar),jsonObject={},jsonObject=e,currentObject.fields=jsonObject.fields,currentObject.buf=jsonObject.buf,currentObject.status="",insertTemplates(),$(".tr-field").map((function(){$(this).remove()})),max_field_id=1,jsonObject.fields){var n=jsonObject.fields[t].cars_or_bikes,s=jsonObject.fields[t].fields,i=jsonObject.fields[t].is_default;for(var a in t>max_field_id&&(max_field_id=t),"c"==n?(n=1,$("#div-section-car").css("display","block")):(n=2,$("#div-section-bike").css("display","block"),"none"!=$("#div-section-car").css("display")&&$("#separator").css("display","block")),g_default_fields)g_default_fields[a].fields;insertField_js(n,t,s,i)}}),"json")}function generate_token(e){for(var t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890".split(""),n=[],s=0;s<e;s++){var i=(Math.random()*(t.length-1)).toFixed(0);n[s]=t[i]}return n.join("")}function getToken(){return g_connected&&(g_token="&stoken="+g_client_token+"&ptoken="+g_server_token),g_token}function replaceWordText(e,t){Word.run((function(n){var s=n.document.body.search(e,{ignorePunct:!0});return n.load(s),n.sync().then((function(){for(var e=0;e<s.items.length;e++)s.items[e].insertText(t,Word.InsertLocation.replace);return n.sync()}))}))}function sendFile(){Office.context.document.getFileAsync("compressed",{sliceSize:1e5},(function(e){if(e.status==Office.AsyncResultStatus.Succeeded){var t=e.value;getSlice({file:t,counter:0,sliceCount:t.sliceCount})}}))}function getSlice(e){e.file.getSliceAsync(e.counter,(function(t){t.status==Office.AsyncResultStatus.Succeeded&&sendSlice(t.value,e)}))}function sendSlice(e,t){var n=e.data;if(n){var s=btoa(n);closeFile(t);var i,a=new Date,c=a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()+" "+a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();currentObject.date=c,currentObject.buf="",i=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),currentObject.buf=s,$.post(gval.serverURI,{template_save:JSON.stringify(currentObject),stoken:g_client_token,ptoken:g_server_token},(function(e){clearTimeout(i),"success"==e.status&&(currentObject.status="",initTemplate_js(),initCars_js(),initUI())}),"json")}}function closeFile(e){e.file.closeAsync((function(e){e.status}))}function insertTemplates(){Word.run((function(e){return e.document.body.insertFileFromBase64(currentObject.buf,Word.InsertLocation.replace),e.sync()}))}function insertFieldValue(e){Word.run((function(t){var n=t.document.getSelection();return n.clear(),n.insertText(" "+e,Word.InsertLocation.start),t.sync()})).catch((function(e){OfficeExtension.Error}))}$((function(){$(window).click((function(e){"myModal"==$(e.target).attr("id")&&($("#dialog-menu").css("display","none"),$("#dialog-setting").css("display","none"),$("#dialog-save").css("display","none"),$("#dialog-template").css("display","none"),$("#dialog-newfolder").css("display","none"),$("#dialog-save-confirm").css("display","none"),$("#dialog-car-name").css("display","none"),$("#dialog-about").css("display","none"),$("#dialog-alert").css("display","none"),$("#myModal").css("display","none"))})),$(document).on("click",".close",(function(){return $(this).parent().parent().css("display","none"),$("#myModal").css("display","none"),!1})),$(document).on("click","#menu",(function(){return updateStatus("kcg="),!1})),$(document).on("click","#menu-template",(function(){return $("#dialog-menu").css("display","none"),$("#dialog-template").css("display","block"),!1})),$(document).on("click","#button-close-template",(function(){return $("#dialog-template").css("display","none"),$("#myModal").css("display","none"),!1})),$(document).on("click","#button-newfolder",(function(){return $("#dialog-template").css("display","none"),$("#dialog-newfolder").css("display","block"),!1})),$(document).on("click","#button-close-newfolder",(function(){return $("#dialog-newfolder").css("display","none"),$("#dialog-template").css("display","block"),!1})),$(document).on("click","#button-save-newfolder",(function(){$("#dialog-newfolder").css("display","none"),$("#dialog-template").css("display","block");var e,t=$("#newfolder").val(),n="?newfolder="+t;e=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),$("#dialog-setting").css("display","none"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),$.get(gval.serverURI+n+g_token,{},(function(n){if("success"==n.status){var s;for(var i in clearTimeout(e),g_dir_names)s<i&&(s=i);s++,g_dir_names[s]=t,insertFileItem_js("dir",s,t,"close"),insertFileItem_js("dir",s,t,""),""==g_current_dir_option&&$("#select-template option").eq(1).before($("<option>["+t+"]</option>"))}}),"json")})),$(document).on("click","#menu-setting",(function(){return $("#dialog-menu").css("display","none"),$("#dialog-setting").css("display","block"),!1})),$(document).on("click","#button-connect",(function(){var e;e=setTimeout((function(){""==g_server_token&&($("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#myModal").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red"),$("#dialog-setting").css("display","none"))}),2e3);var t="";g_server_token&&(t="&disconnect"),$.get(gval.serverURI+"?stoken="+g_client_token+t,{},(function(t){"success"==t.status?(g_server_token=t.plugin_token,g_connected=!0,alarm("Connected to API",""),$("#div-alarm").css("color","green"),getToken(),initTemplate_js(),initCars_js(),initUI(),clearTimeout(e),$("#dialog-setting").css("display","none"),$("#myModal").css("display","none")):"disconnect"==t.status?(alarm("Go Setting & Connect to API",""),$("#div-alarm").css("color","red"),$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),$("#dialog-setting").css("display","none"),$("#myModal").css("display","none"),$("#copied-token").val(""),document.getElementById("select-template").innerHTML="",initUI(),g_server_token="",clearTimeout(e)):(alarm("Can't connect to Server",""),$("#div-alarm").css("color","red"),$("#dialog-setting").css("display","none"),$("#myModal").css("display","none"))}),"json")})),$(document).on("click","#button-cancel-setting",(function(){return $("#dialog-setting").css("display","none"),$("#myModal").css("display","none"),!1})),$(document).on("click","#menu-about",(function(){return $("#dialog-menu").css("display","none"),$("#dialog-about").css("display","block"),!1})),$(document).on("click","#button-close-about",(function(){return $("#myModal").css("display","none"),$("#dialog-about").css("display","none"),!1})),$(document).on("click","#button-close-alert",(function(){return $("#myModal").css("display","none"),$("#dialog-about").css("display","none"),!1})),$(document).on("click","#save-template",(function(){return 1==g_new_template&&$("#save-doc-name").val(""),$("#myModal").css("display","block"),$("#dialog-save").css("display","block"),!1})),$(document).on("click","#button-close-savetemplate",(function(){return $("#dialog-save").css("display","none"),$("#myModal").css("display","none"),!1})),$(document).on("click","#button-save-template",(function(){var e="",t="",n=!1;if(""!=(e=$("#save-doc-name").val())){for(var s in e.endsWith(".docx")||(e+=".docx"),t=""!=g_current_dir?g_current_dir+"/"+e:e,g_template_names)if(t==g_template_names[s]){n=!0;break}$("#dialog-save").css("display","none"),1==n?$("#dialog-overwrite").css("display","block"):($("#myModal").css("display","none"),currentObject.fname=t,"add"==currentObject.status&&(currentObject.id=-1),sendFile())}})),$(document).on("click","#button-no-overwrite",(function(){return $("#dialog-overwrite").css("display","none"),$("#myModal").css("display","none"),!1})),$(document).on("click","#button-yes-overwrite",(function(){$("#dialog-overwrite").css("display","none"),$("#dialog-save").css("display","none"),$("#myModal").css("display","none");var e,t="";for(var n in(t=$("#save-doc-name").val()).endsWith(".docx")||(t+=".docx"),e=""!=g_current_dir?g_current_dir+"/"+t:t,currentObject.fname=e,"add"!=currentObject.status&&""!=currentObject.status||(currentObject.status="replace"),g_template_names)if(e==g_template_names[n]){currentObject.id=n;break}return sendFile(),!0})),$(document).on("click","#add-template",(function(){return"update"==currentObject.status?($("#myModal").css("display","block"),$("#dialog-save-confirm").css("display","block")):(g_new_template=1,currentObject.status="add",initTemplate_js(),initCars_js(),initUI()),!1})),$(document).on("click","#button-yes-confirm",(function(){$("#dialog-save-confirm").css("display","none"),1==g_new_template&&$("#save-doc-name").val(""),$("#dialog-save").css("display","block")})),$(document).on("click","#button-no-confirm",(function(){$("#dialog-save-confirm").css("display","none"),$("#myModal").css("display","none"),g_new_template=1,currentObject.status="",initTemplate_js()})),$(document).on("click","#button-cancel-confirm",(function(){$("#dialog-save-confirm").css("display","none"),$("#myModal").css("display","none")})),$(document).on("click",".file-delete",(function(){var e=$(this).parent().parent("tr"),t=$(this).attr("id"),n=t.split("-")[1];t=t.split("-")[2];var s,i="",a="?";return"dir"==n?($(this).parent().parent().children(".dir-name").map((function(){i=$(this).html()})),a="?delete_dir="+i):a="?delete_file="+(i=g_template_names[t]),s=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),$.get(gval.serverURI+a+g_token,{},(function(a){var c;if("success"==a.status){if(clearTimeout(s),e.remove(),"file"==n){for(c in g_template_names)i==g_template_names[c]&&delete g_template_names[c];$("#select-template option[value="+t+"]").remove()}else{for(c in g_dir_names)i==g_dir_names[c]&&delete g_dir_names[c];$("#select-template option").map((function(){$(this).html().startsWith("["+i+"]")&&$(this).remove()}))}"file"==n?$("#tbody-saved-files > #tr-file-"+t).remove():$("#tbody-saved-dirs > #tr-dir-"+t).remove(),g_template_id==t&&($("#select-template option").last().prop("selected",!0),changeTemplate_js())}}),"json"),!0})),$(document).on("click",".copy-doc",(function(){$(this).parent().parent("tr");var e,t,n=$(this).attr("id");return n=n.split("-")[2],$(this).parent().parent().children(".file-name").map((function(){$(this).html()})),e="?copy_file="+n,t=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),$.get(gval.serverURI+e+g_token,{},(function(e){if("success"==e.status){clearTimeout(t);var n=e.id,s=e.name,i="";g_template_names[n]=s;var a=s.split("/");a.length>1&&(i=a[0],s=a[1]),g_current_dir_option==i&&$("#select-template").append(new Option(s,n)),insertFileItem_js("file",n,s,"close"),insertFileItem_js("file",n,s,"")}}),"json"),!0})),$(document).on("click",".dir-name",(function(){$("#button-newfolder").attr("disabled",!0);var e,t="";for(var n in e=$(this).html(),g_current_dir=e,$("#tbody-saved-dirs tr.tr-up").css("display","block"),$("#tbody-template-dir tr.tr-up").css("display","block"),$("#tbody-template-dir tr.tr-file").remove(),$("#tbody-template-file tr.tr-file").remove(),$("#tbody-saved-dirs tr.tr-file").remove(),$("#tbody-saved-files tr.tr-file").remove(),$("#tbody-saved-files tr.tr-file").remove(),g_template_names){var s=g_template_names[n];s.startsWith(e+"/")&&(insertFileItem_js("file",n,t=s.split("/")[1],"close"),insertFileItem_js("file",n,t,""))}return!0})),$(document).on("click",".dir-up",(function(){return $("#button-newfolder").attr("disabled",!1),$("#tbody-saved-dirs tr.tr-up").css("display","none"),$("#tbody-template-dir tr.tr-up").css("display","none"),g_current_dir="",initFileList_js(),!0})),$(document).on("click",".delete-section",(function(){$(this).parents(".div-section").map((function(){$(this).css("display","none"),$(this).find(".field-value").val(""),$(this).find(".field-value").remove()}));var e=$(this).attr("id").split("-")[1];for(field_id in g_type_atoi[e],e=e[0],currentObject.fields)currentObject.fields[field_id].cars_or_bikes==e&&("add"==currentObject.fields[field_id].status?currentObject.fields[field_id].status="ignore":"ignore"!=currentObject.fields[field_id].status&&(currentObject.fields[field_id].status="delete"));return"add"!=currentObject.status&&(currentObject.status="update"),template_status="update",!1})),$(document).on("click",".insert-field-value",(function(){insertFieldValue($(this).parents(".tr-field").find(".field-name").val())})),$(document).on("click",".delete-field",(function(){var e=$(this).attr("id").split("-");if(e.length<2)return $("#dialog-alert").css("display","block"),!1;var t=e[2];return $(this).parents(".tr-field").map((function(){$(this).remove()})),"add"==currentObject.fields[t].status?currentObject.fields[t].status="ignore":currentObject.fields[t].status="delete","add"!=currentObject.status&&(currentObject.status="update"),template_status="update",!1})),$(document).on("click",".add-field",(function(){max_car_value_id++,max_field_id++;var e=$(this).attr("id").split("-")[2],t="new_field";insertField_js(g_type_atoi[e],max_field_id,t);var n=max_field_id;return currentObject.fields[n]={},currentObject.fields[n].id=-1,currentObject.fields[n].fields=t,currentObject.fields[n].cars_or_bikes=e[0],currentObject.fields[n].is_default="0",currentObject.fields[n].status="add","add"!=currentObject.status&&(currentObject.status="update"),!0})),$(document).on("change",".field-value",(function(){var e=$(this).attr("id"),t=$(this).val(),n=e.split("-");if(n.length<4)return $("#dialog-alert").css("display","block"),!1;var s=n[2],i="";return $(this).parents("tbody").map((function(){$(this).find(".field-name").map((function(){var e=$(this).attr("id"),t=e.split("-");if(t.length<4)return $("#dialog-alert").css("display","block"),!1;if(e=t[2],s==e){var n=$(this).val().match(/[a-zA-Z]+[a-zA-Z0-9_]+/g);for(var a in g_default_fields)n==g_default_fields[a].fields&&(i=n);return""!=i&&void 0}}))})),$(this).parents(".table-section").map((function(){var e=$(this).find(".select").val();currentObject.cars[e][i]=t,"add"!=currentObject.cars[e].status&&(currentObject.cars[e].status="update")})),"add"!=currentObject.status&&(currentObject.status="update"),!0})),$(document).on("focusout",".field-name",(function(){var e,t=$(this).attr("id"),n=$(this).val(),s=t.split("-");if(s.length<4)return $("#dialog-alert").css("display","block"),!1;var i=s[2],a=n.match(/[a-zA-Z]+[a-zA-Z0-9_]+/g);for(var c in g_default_fields)if(a==g_default_fields[c].fields)return!1;return a=a[0],e="car"==s[3]?"[#1_"+a+"]":"[#2_"+a+"]",$(this).val(e),currentObject.fields[i].fields!=a&&(currentObject.fields[i].fields=a,-1!=currentObject.fields[i].id&&(currentObject.fields[i].status="update"),"add"!=currentObject.status&&(currentObject.status="update"),!0)})),$(document).on("focus",".field-name",(function(){var e=$(this).attr("id"),t=$(this).val();if(e.split("-").length<4)return $("#dialog-alert").css("display","block"),!1;var n=t.match(/[a-zA-Z]+[a-zA-Z0-9_]+/g);for(var s in g_default_fields)if(n==g_default_fields[s].fields)return!1;return $(this).val(n),!0})),$(document).on("change",".select",(function(){var e=$(this).attr("id");g_car_id=$(this).val();var t,n=e.split("-"),s=$(this),i="";t=setTimeout((function(){g_server_token="",g_token="",$("#table-setting-success").css("display","none"),$("#table-setting").css("display","block"),$("#button-connect").html("Connect"),alarm("Can't connect to Server",""),$("#div-alarm").css("color","red")}),2e3),$.get(gval.serverURI+"?car="+g_car_id+g_token,{},(function(e){if(clearTimeout(t),jsonObject={},jsonObject=e,n.length<2)return $("#dialog-alert").css("display","block"),!1;var a;currentObject.cars[g_car_id]={},currentObject.cars[g_car_id]=jsonObject,$(s).parents(".div-section").map((function(){var e=$(this);$(this).find(".field-name").map((function(){n=$(this).attr("id").split("-"),a=n[2];var t=$(this).val().match(/[a-zA-Z]+[a-zA-Z0-9_]+/g);for(var s in i="",g_default_fields)if(t==g_default_fields[s].fields){i=t;break}if(""==i)return!1;e.find(".field-value").map((function(){var e=$(this).attr("id");e=$(this).attr("id").split("-")[2],a==e&&$(this).val(jsonObject[i])}))}))}))}),"json")})),$("#button-insert-motorbike").click((function(){"none"==$("#div-section-bike").css("display")&&($("#div-section-bike").css("display","block"),"none"!=$("#div-section-car").css("display")&&$("#separator").css("display","block"),g_is_new=!0,insertSection_js(2),g_is_new=!1)})),$("#button-insert-car").click((function(){"none"==$("#div-section-car").css("display")&&($("#div-section-car").css("display","block"),g_is_new=!0,insertSection_js(1),g_is_new=!1)})),$("#button-save-carname").click((function(){var e,t=$("#input-new-car-name").val();for(var n in $("#dialog-car-name").css("display","none"),e=1==g_cc_type?"c":"b",currentObject.fields)currentObject.fields[n].cars_or_bikes==e&&delete currentObject.fields[n];insertSection_js(g_cc_type),carOptions+='<option value="'+max_car_id+'">'+t+"</option>",document.getElementById("select-car").innerHTML=carOptions,document.getElementById("select-bike").innerHTML=carOptions,currentObject.cars[max_car_id].title=t,currentObject.cars[max_car_id].status="add",$(".select").val(max_car_id)})),$("#button-cancel-carname").click((function(){$("#dialog-car-name").css("display","none")})),$("#button-fillout").click((function(){})),$("#button-reset").click((function(){insertTemplates()})),$(document).on("click","#select-template",(function(e){return $("#select-template option").length<2&&$(this).val().startsWith("..")?(g_current_dir_option="",initTemplate_js()):"update"==currentObject.status&&(e.stopPropagation(),$("#dialog-save-confirm").dialog("open")),!0})),$(document).on("input","#save-doc-name",(function(e){var t=$(this).val();for(var n in g_template_names)if(t==g_template_names[n])return $(this).css("border-color","red"),!0;return $(this).css("border-color","black"),!0}))})),$(document).ready((function(){g_client_token=generate_token(32),$("#new-token").val(g_client_token),document.getElementById("app-body").style.display="flex",document.getElementById("select-template").onchange=changeTemplate_js})),Office.onReady((function(e){e.host===Office.HostType.Word&&Office.context.requirements.isSetSupported("WordApi","1.3")}))})();
//# sourceMappingURL=taskpane.js.map